import React from "react";
import { Tabs, Tab, Card, CardBody } from "@heroui/react";
import { motion } from "framer-motion";
import { useLanguage } from "../context/LanguageContext";

const LegalPage: React.FC = () => {
  const { t } = useLanguage();
  const [selected, setSelected] = React.useState("terms");

  const termsContent = `
# ${t("legal.terms")}

## 1. Общие положения

1.1. Настоящие Условия использования (далее — «Условия») регулируют отношения между DORM Community (далее — «Компания») и пользователями платформы (далее — «Пользователи»).

1.2. Используя платформу DORM, Пользователь подтверждает, что полностью принимает настоящие Условия.

## 2. Регистрация и учетная запись

2.1. Для использования всех функций платформы Пользователю необходимо создать учетную запись.

2.2. Пользователь обязуется предоставлять достоверную информацию при регистрации и поддерживать ее актуальность.

2.3. Пользователь несет ответственность за сохранность своих учетных данных и за все действия, совершенные с использованием его учетной записи.

## 3. Правила использования платформы

3.1. Пользователь обязуется не использовать платформу для:
- нарушения законодательства РФ;
- распространения вредоносного программного обеспечения;
- нарушения прав интеллектуальной собственности;
- распространения спама и рекламы без согласия Компании.

3.2. Компания оставляет за собой право ограничить доступ Пользователя к платформе в случае нарушения настоящих Условий.

## 4. Интеллектуальная собственность

4.1. Все права на контент, размещенный на платформе Компанией, принадлежат Компании или используются с разрешения правообладателей.

4.2. Пользователь сохраняет права на контент, который он размещает на платформе, но предоставляет Компании неисключительную лицензию на его использование в рамках функционирования платформы.

## 5. Ограничение ответственности

5.1. Компания не несет ответственности за:
- действия третьих лиц;
- потерю данных Пользователя;
- упущенную выгоду и другие косвенные убытки.

5.2. Платформа предоставляется «как есть», без каких-либо гарантий.

## 6. Изменение условий

6.1. Компания оставляет за собой право изменять настоящие Условия в одностороннем порядке.

6.2. Новая редакция Условий вступает в силу с момента ее размещения на платформе.

## 7. Заключительные положения

7.1. Настоящие Условия регулируются законодательством Российской Федерации.

7.2. Все споры, возникающие между Компанией и Пользователем, подлежат разрешению путем переговоров, а в случае невозможности достижения согласия — в судебном порядке.
  `;

  const privacyContent = `
# ${t("legal.privacy")}

## 1. Общие положения

1.1. Настоящая Политика конфиденциальности (далее — «Политика») определяет порядок обработки и защиты персональных данных пользователей платформы DORM Community (далее — «Пользователи»).

1.2. Используя платформу, Пользователь дает согласие на обработку своих персональных данных в соответствии с настоящей Политикой.

## 2. Собираемая информация

2.1. Компания собирает следующие категории персональных данных:
- Информация, предоставляемая при регистрации (имя, email, год рождения);
- Информация о действиях Пользователя на платформе;
- Техническая информация (IP-адрес, тип устройства, браузер).

2.2. Компания не собирает и не обрабатывает специальные категории персональных данных.

## 3. Цели обработки данных

3.1. Компания обрабатывает персональные данные Пользователей для:
- Предоставления доступа к функциям платформы;
- Улучшения качества сервиса;
- Коммуникации с Пользователями;
- Аналитики использования платформы;
- Соблюдения требований законодательства.

## 4. Хранение и защита данных

4.1. Компания принимает необходимые организационные и технические меры для защиты персональных данных от неправомерного доступа, уничтожения, изменения, блокирования, копирования и распространения.

4.2. Персональные данные Пользователей хранятся на защищенных серверах, расположенных на территории Российской Федерации.

4.3. Срок хранения персональных данных определяется целями их обработки, требованиями законодательства и внутренними документами Компании.

## 5. Передача данных третьим лицам

5.1. Компания не передает персональные данные Пользователей третьим лицам, за исключением случаев:
- Наличия согласия Пользователя;
- Требования законодательства;
- Передачи данных партнерам Компании для обеспечения функционирования платформы.

5.2. При передаче данных партнерам Компания обеспечивает соблюдение ими требований конфиденциальности.

## 6. Права Пользователей

6.1. Пользователь имеет право:
- Получать информацию о обработке своих персональных данных;
- Требовать уточнения, блокирования или уничтожения своих персональных данных;
- Отозвать согласие на обработку персональных данных.

6.2. Для реализации своих прав Пользователь может обратиться к Компании по указанным на платформе контактным данным.

## 7. Изменение Политики

7.1. Компания оставляет за собой право изменять настоящую Политику в одностороннем порядке.

7.2. Новая редакция Политики вступает в силу с момента ее размещения на платформе.

## 8. Контактная информация

8.1. По вопросам, связанным с обработкой персональных данных, Пользователь может обратиться по адресу: dormcommunity@gmail.com.
  `;

  const renderMarkdown = (content: string) => {
    const lines = content.split("\n");
    return lines.map((line, index) => {
      if (line.startsWith("# ")) {
        return <h1 key={index} className="text-3xl font-mono font-bold mb-6 text-accent-orange">{line.substring(2)}</h1>;
      } else if (line.startsWith("## ")) {
        return <h2 key={index} className="text-2xl font-mono font-bold mt-8 mb-4">{line.substring(3)}</h2>;
      } else if (line.startsWith("### ")) {
        return <h3 key={index} className="text-xl font-mono font-bold mt-6 mb-3">{line.substring(4)}</h3>;
      } else if (line.startsWith("- ")) {
        return <li key={index} className="ml-6 mb-2">{line.substring(2)}</li>;
      } else if (line.trim() === "") {
        return <br key={index} />;
      } else {
        return <p key={index} className="mb-4">{line}</p>;
      }
    });
  };

  return (
    <div className="pt-header py-16 bg-background">
      <div className="container mx-auto max-w-container px-6">
        <motion.h1
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.6 }}
          className="text-4xl font-poppins font-black text-center mb-12"
        >
          {t("footer.legal")}
        </motion.h1>

        <Tabs
          aria-label="Legal documents"
          selectedKey={selected}
          onSelectionChange={setSelected as any}
          className="mb-8"
        >
          <Tab key="terms" title={t("legal.terms")}>
            <Card>
              <CardBody className="font-mono">
                {renderMarkdown(termsContent)}
              </CardBody>
            </Card>
          </Tab>
          <Tab key="privacy" title={t("legal.privacy")}>
            <Card>
              <CardBody className="font-mono">
                {renderMarkdown(privacyContent)}
              </CardBody>
            </Card>
          </Tab>
        </Tabs>
      </div>
    </div>
  );
};

export default LegalPage;
